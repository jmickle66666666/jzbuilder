var JZBuilder;!function(JZBuilder){!function(EditMode){EditMode[EditMode.VERTEX=0]="VERTEX",EditMode[EditMode.LINE=1]="LINE",EditMode[EditMode.SECTOR=2]="SECTOR",EditMode[EditMode.THING=3]="THING"}(JZBuilder.EditMode||(JZBuilder.EditMode={}));var BuilderCanvas=function(){function BuilderCanvas(canvas){this.CANVAS_BG_COLOR="#434043",this.GRID_COLOR="#000000",this.GRID_CENTER_COLOR="#888888",this.DRAWLINE_COLOR="#998811",this.MAPLINE_COLOR="#cccccc",this.HIGHLIGHTLINE_COLOR="#FFFFFF",this.VERTEX_COLOR="#FF8811",this.DRAWVERTEX_COLOR="#FFFFFF",this.SECTOR_COLOR="#22441144",this.SELECTEDLINE_COLOR="#FFAA11",this.LINE_SELECT_DISTANCE=5,this.VERTEX_SIZE=2,this.ZOOM_SPEED=1.05,this.GRIDLINE_WIDTH=.5,this.viewOffset=new JZBuilder.Point(-400,-300),this.zoom=1,this.gridSize=32,this.canvas=canvas,this.ctx=this.canvas.getContext("2d")}return BuilderCanvas.prototype.posToView=function(p){return new JZBuilder.Point(p.x/this.zoom-this.viewOffset.x,p.y/this.zoom-this.viewOffset.y)},BuilderCanvas.prototype.viewToPos=function(p){return new JZBuilder.Point((p.x+this.viewOffset.x)*this.zoom,(p.y+this.viewOffset.y)*this.zoom)},BuilderCanvas.prototype.redraw=function(){this.drawGrid(),this.drawSectors(),this.drawMapLines(),this.drawDrawLines(),this.drawVertexes(),this.drawSelectedLines(),this.drawHighlightedLines()},BuilderCanvas.prototype.drawGrid=function(){var i;for(this.ctx.fillStyle=this.CANVAS_BG_COLOR,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.lineWidth=this.GRIDLINE_WIDTH,this.ctx.strokeStyle=this.GRID_COLOR,i=0;i<this.canvas.width;i++)(i+this.viewOffset.x)%Math.round(this.gridSize/this.zoom)==0&&(i+this.viewOffset.x==0&&(this.ctx.strokeStyle=this.GRID_CENTER_COLOR),this.ctx.beginPath(),this.ctx.moveTo(i,0),this.ctx.lineTo(i,this.canvas.height),this.ctx.stroke(),i+this.viewOffset.x==0&&(this.ctx.strokeStyle=this.GRID_COLOR));for(i=0;i<this.canvas.width;i++)(i+this.viewOffset.y)%Math.round(this.gridSize/this.zoom)==0&&(i+this.viewOffset.y==0&&(this.ctx.strokeStyle=this.GRID_CENTER_COLOR),this.ctx.beginPath(),this.ctx.moveTo(0,i),this.ctx.lineTo(this.canvas.height,i),this.ctx.stroke(),i+this.viewOffset.y==0&&(this.ctx.strokeStyle=this.GRID_COLOR))},BuilderCanvas.prototype.drawSectors=function(){},BuilderCanvas.prototype.drawMapLines=function(){this.drawLines(this.mapData.lines,this.MAPLINE_COLOR)},BuilderCanvas.prototype.drawDrawLines=function(){},BuilderCanvas.prototype.drawVertexes=function(){},BuilderCanvas.prototype.drawSelectedLines=function(){},BuilderCanvas.prototype.drawHighlightedLines=function(){},BuilderCanvas.prototype.drawLines=function(lines,color,width){void 0===width&&(width=1)},BuilderCanvas}();JZBuilder.BuilderCanvas=BuilderCanvas}(JZBuilder||(JZBuilder={})),function(JZBuilder){new JZBuilder.BuilderCanvas(document.getElementById("maincanvas"))}(JZBuilder||(JZBuilder={})),function(JZBuilder){var MapData=function(){};JZBuilder.MapData=MapData}(JZBuilder||(JZBuilder={})),function(JZBuilder){var Point=function(x,y){this.x=x,this.y=y};JZBuilder.Point=Point;var Rect=function(){function Rect(x,y,width,height){void 0===x&&(x=0),void 0===y&&(y=0),void 0===width&&(width=0),void 0===height&&(height=0),this.topLeft=new Point(x,y),this.bottomRight=new Point(x+width,y+height)}return Object.defineProperty(Rect.prototype,"midPoint",{get:function(){return new Point((this.topLeft.x+this.bottomRight.x)/2,(this.topLeft.y+this.bottomRight.y)/2)},enumerable:!0,configurable:!0}),Object.defineProperty(Rect.prototype,"width",{get:function(){return this.bottomRight.x-this.topLeft.x},enumerable:!0,configurable:!0}),Object.defineProperty(Rect.prototype,"height",{get:function(){return this.bottomRight.y-this.topLeft.y},enumerable:!0,configurable:!0}),Rect.prototype.pointInBounds=function(p){return p.x>=this.topLeft.x&&p.y>=this.topLeft.y&&p.x<this.bottomRight.x&&p.y<this.bottomRight.y},Rect}();JZBuilder.Rect=Rect;var Sector=function(){function Sector(){this.floorTexture=document.createElement("img"),this.floorTexture.src="JZCRATE2"}return Sector.prototype.invalidate=function(){if(0!=this.lines.length){this.bounds=new Rect;for(var i=0;i<this.lines.length;i++)this.bounds.topLeft.x=Math.min(this.bounds.topLeft.x,this.lines[i].start.x,this.lines[i].end.x),this.bounds.topLeft.y=Math.min(this.bounds.topLeft.y,this.lines[i].start.y,this.lines[i].end.y),this.bounds.bottomRight.x=Math.max(this.bounds.bottomRight.x,this.lines[i].start.x,this.lines[i].end.x),this.bounds.bottomRight.y=Math.max(this.bounds.bottomRight.x,this.lines[i].start.y,this.lines[i].end.y);this.preview=document.createElement("canvas"),this.preview.width=this.bounds.width,this.preview.height=this.bounds.height;var ctx=this.preview.getContext("2d");for(ctx.beginPath(),ctx.moveTo(this.lines[0].start.x-this.bounds.topLeft.x,this.lines[0].start.y-this.bounds.topLeft.y),i=0;i<this.lines.length;i++)ctx.lineTo(this.lines[i].end.x-this.bounds.topLeft.x,this.lines[i].end.y-this.bounds.topLeft.y);ctx.imageSmoothingEnabled=!1,ctx.clip();var ox=this.bounds.topLeft.x%64,oy=this.bounds.topLeft.y%64;for(i=-ox-64;i<this.bounds.width;i+=64)for(var j=-oy-64;j<this.bounds.height;j+=64)ctx.drawImage(this.floorTexture,i,j)}},Sector}();JZBuilder.Sector=Sector;var Line=function(start,end){this.start=start,this.end=end};JZBuilder.Line=Line}(JZBuilder||(JZBuilder={})),JZBuilder||(JZBuilder={});
//# sourceMappingURL=jzbuilder.min.js.map